<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>{{ goods.name }} - 暖心商城</title>
    <style>
        /* 复用首页样式 + 详情页专属样式 */
        .detail-container { display: flex; gap: 20px; padding: 20px; }
        .goods-img { width: 400px; }
        .goods-img img { width: 100%; height: 400px; object-fit: cover; }
        .goods-info { flex: 1; }
        .btn { background: #e91e63; color: white; border: none; padding: 10px 20px; cursor: pointer; margin-top: 20px; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
    </style>
</head>
<body>
    <!-- 复用header导航 -->
    <div class="header">
        <h1>暖心商城</h1>
        <div class="nav">
            <a href="{% url 'home' %}">首页</a>
            <a href="{% url 'category' %}">商品分类</a>
            {% if user.is_authenticated %}
                <a href="{% url 'cart_list' %}">购物车</a>
                <a href="{% url 'order_list' %}">我的订单</a>
                <a href="{% url 'logout' %}">登出</a>
            {% else %}
                <a href="{% url 'login' %}?next={{ request.path }}">登录</a>
                <a href="{% url 'register' %}">注册</a>
            {% endif %}
        </div>
    </div>

    <div class="detail-container">
        <div class="goods-img">
            {% if goods_images.first %}
                <img src="{{ goods_images.first.image.url }}" alt="{{ goods.name }}">
            {% else %}
                <img src="/static/default.png" alt="默认图片">
            {% endif %}
        </div>
        <div class="goods-info">
            <h2>{{ goods.name }}</h2>
            <p class="price">¥{{ goods.price }}</p>
            <p>分类：{{ goods.category.name }}</p>
            <p>库存：{{ goods.stock }}件</p>
            <p>状态：{% if goods.status == 'ON_SALE' %}<span style="color: green;">已上架</span>{% else %}<span style="color: red;">已下架</span>{% endif %}</p>
            <div style="margin: 20px 0;">
                <h3>商品详情</h3>
                <div>{{ goods.description|safe }}</div>
            </div>
            {% if goods.status == 'ON_SALE' and goods.stock > 0 %}
                {% if user.is_authenticated %}
                    <a href="{% url 'cart_add' goods.id %}" class="btn">加入购物车</a>
                {% else %}
                    <a href="{% url 'login' %}?next={{ request.path }}" class="btn">登录后购买</a>
                {% endif %}
            {% else %}
                <button class="btn" disabled>已售罄/下架</button>
            {% endif %}
        </div>
    </div>
</body>
</html>
